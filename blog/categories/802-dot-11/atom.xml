<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 802.11 | #error NO_MONEY]]></title>
  <link href="http://enukane.github.io/blog/categories/802-dot-11/atom.xml" rel="self"/>
  <link href="http://enukane.github.io/"/>
  <updated>2017-01-11T19:02:33+09:00</updated>
  <id>http://enukane.github.io/</id>
  <author>
    <name><![CDATA[n_kane]]></name>
    <email><![CDATA[enukane@glenda9.org]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[2017-01-11 コミケ91で、ハニーポット無線LANアクセスポイント立てたお話]]></title>
    <link href="http://enukane.github.io/blog/2017/01/11/hap/"/>
    <updated>2017-01-11T09:35:12+09:00</updated>
    <id>http://enukane.github.io/blog/2017/01/11/hap</id>
    <content type="html"><![CDATA[<p><ul>
 <li><a href="#L......">概要</a></li>
 <li><a href="#L..................AP............">ハニーポットAPの見え方</a></li>
 <li><a href="#L..................AP.....................">ハニーポットAPの機材について</a>
 <ul>
  <li><a href="#AP......">AP本体</a></li>
  <li><a href="#AP..................">APへの電源供給</a></li>
  <li><a href="#L.....................................on.OpenWRT">簡易キャプティブポータル on OpenWRT</a></li>
  <li><a href="#L............">設置場所</a></li>
 </ul>
 </li>
 <li><a href="#L............">提供結果</a>
 <ul>
  <li><a href="#L......LAN">無線LAN</a></li>
  <li><a href="#DHCP">DHCP</a></li>
  <li><a href="#DNS..........">DNS クエリ</a></li>
  <li><a href="#L..............................">キャプティブポータル</a></li>
 </ul>
 </li>
 <li><a href="#L.........">まとめ</a></li>
 <li><a href="#Future.Work">Future Work</a></li>
</ul>

</p>

<a name="L......"></a>
<h1>概要</h1>

<p>今冬のコミックマーケット91にて、1日目 西1 み-18a &ldquo;glenda9&rdquo; で出展するにあたって
自スペースにハニーポット無線LANアクセスポイント(以下 ハニポAP)を立てました。
ここではその提供方法、構成および結果について記述します。</p>

<p>この手のイベントでは「応仁のLAN」といった面白SSIDを告知する遊びをする人がいます。
これに倣って自分のスペース名をSSIDで告知というのも可能ですが、
せっかくAPを立てるからにはもうすこし遊びを入れたいところです。</p>

<p>もうちょっと真面目な目的としては各種プラットフォームが備えているキャプティブポータル検知の実装を見てみたい、
この手のイベントでいかにもセキュリティの甘そうなAPをおいておくと
どれくらいの人が引っかかるのか見てみたいといったモチベーションがありました。</p>

<p>ここではAPとキャプティブポータルを組み合わせてイベント環境にデプロイし、
クライアントの通信を特定コンテンツにねじ曲げて以下の様なページを強制表示するようにしつつ各種ログを収集しました。</p>

<p><img class="center" src="/images/2017-01-11/captive-webui.png" width="350"></p>

<!---
# 目的

- APを用いた宣伝、お客さんを釣る
- どれくらいの人がハニポAPに引っかかるかをみる
- キャプティブポータル検知の仕組みを実際に引っかけて調べる

先にも述べたように単純にSSIDを「み-18a glenda9」などとして宣伝する方法もあります。
が、一般的なハニーポットとしては"Free Wi-Fi"といったそれらしいSSIDをつけておきたいところです。
威力業務妨害扱いにもなりそうなので、今回はやりませんでしたが他のFree Wi-Fiで用いている
SSIDをつけるという案もあります。
コミケの環境では、PCというよりスマホ・タブレットが主として用いられると思われ
またさらにいえばWi-Fiよりは3G/LTEを用いるであろうと思われるためあまり引っかかる人はいなさそうです。
しかし、無線LANがデフォルト有効かつ暗号化なしSSIDに自動的に接続しに行くデバイスや、
テザリング接続時にたまたまフリーっぽいSSIDを見つけて手動接続するユーザはいると思われます。
これらをターゲットとしてSSIDを告知します。

各種プラットフォームではそれぞれ [HOW AUTOMATIC DETECTION OF CAPTIVE PORTAL WORKS](https://success.tanaza.com/s/article/How-Automatic-Detection-of-Captive-Portal-works)にあるようなキャプティブポータル検知の仕組みを導入しています。
これを実際に調べるとともに、この際に発生する接続からアドレス取得、名前解決からHTTPアクセスまでの
一連の流れから読み取れることを探ってみます。

-->


<a name="L..................AP............"></a>
<h1>ハニーポットAPの見え方</h1>

<p>ハニポAPのSSIDとして「  Not Free Wi-Fi」を告知するようにしました。
SSIDの先頭に半角スペースを2つ入れることで、
「0000」で始まるものやアンダースコアから始まるSSIDよりも上位に出現するようにしています。
2.4GHz帯と5GHz帯でSSIDを分けており、
下記の様に2.4GHz帯側には&#8221;-g&#8221;とのサフィクスをつけました。</p>

<p><img class="center" src="/images/2017-01-11/not-free-wifi-ssid_hide.png" width="300"></p>

<!--- 引っかかると --->


<p>このSSIDに接続すると、
大抵のプラットフォームに入っているキャプティブポータル検知の仕組みによりスプラッシュページが表示されます。
Androidのスマホで見ると、ハニーポットAPのSSIDを選択後しばらくすると以下の画面がポップアップします。</p>

<p><img class="center" src="/images/2017-01-11/sp-captive.jpg" width="300"></p>

<a name="L..................AP....................."></a>
<h1>ハニーポットAPの機材について</h1>

<a name="AP......"></a>
<h2>AP本体</h2>

<p>ハニーポットAPには、Buffalo WZR-HP-AG300H に OpenWRT を載せたものを用いました。</p>

<p><img class="center" src="/images/2017-01-11/hap.png" width="300"></p>

<p>C90で同様の試みをしたときは Raspberry Pi と USB Wi-Fi アダプタを用いていました(以下)。
その際は、混雑している2.4GHz帯でしか運用せず出力も弱めであったため、
あまり接続数を稼げませんでした。</p>

<p><img class="center" src="/images/2017-01-11/old-hap.png" width="300"></p>

<p>WZR-HP-AG300H は家庭用APとしてそれなりにきちんとしたアンテナを備え、
2.4GHz/5GHz帯の同時運用も可能です。
OpenWRT を導入できカスタマイズ性も高いため今回はこれを用いてハニーポットAPを実装しました。</p>

<a name="AP.................."></a>
<h2>APへの電源供給</h2>

<p>WZR-HP-AG300Hの消費電力は最大13.2Wであり、付属のACアダプタは定格 12V/2.0A となっています。
通常のUSBモバイルバッテリーではここまでの電圧は出せないため、
簡単にやるにはACが取れる電源などの大きめのバッテリーを用意する必要があります。
これらは価格も高い上にでかいし重いしで大変に邪魔なので、
ここでは以下のページに従ってQuickCharge 2.0対応のバッテリー(今回は AUKEY PB-T4 を利用)から12Vを引き出すようにしました。</p>

<ul>
<li><a href="https://lowreal.net/2015/12/07/3">Quick Charge 2.0 電源から 12V とる</a></li>
</ul>


<p>なお上記ページのコードでは上手く動かなかったため、
挿入するディレイの長さを変更して運用しています。コードは下記をご参照ください。</p>

<ul>
<li><a href="https://gist.github.com/enukane/26f3af8938ed2a775296f472b1c71168">https://gist.github.com/enukane/26f3af8938ed2a775296f472b1c71168</a></li>
</ul>


<p>後述するとおり 10000mAh のバッテリーで6時間程度は運用できました。</p>

<a name="L.....................................on.OpenWRT"></a>
<h2>簡易キャプティブポータル on OpenWRT</h2>

<p>簡易キャプティブポータル実現のため、以下の細工を入れています。</p>

<ul>
<li>管理用WebUIはWAN側インタフェースでのみ受付</li>
<li>LAN から WAN への通信を全て遮断</li>
<li>DHCPで配布するDNSサーバを自身(10.0.0.1)に設定</li>
<li>DNSサーバにて全てのAレコードのクエリに対して自身のアドレスで応答</li>
<li>LAN側(キャプティブポータル提供側)では Apache で HTTP アクセスを待ち受け

<ul>
<li>全てのHTTPアクセスを /index.html に置き換え</li>
</ul>
</li>
</ul>


<p>dnsmasqのレコード上書き機能を用いて
これを用いて全てのホスト名に対して自分のアドレスを返すことで、
アクセスを自身にねじ曲げます。
現状 /etc/init.d/dnsmasq にて dnsmasq コマンドの引数に以下を
加えてこれを実現しています。本来的には /etc/config/dhcp に list address の
行を追加すれば動くはずですが、上手く動作しないようでした。</p>

<pre><code>--address='/#/10.0.0.1'
</code></pre>

<p>キャプティブポータルとして HTTP アクセスを受け付ける側には Apache を用います。
上記 DNS の細工により、HTTP アクセスはこちらに向きますがパスは不定のためリダイレクト等が必要です。
OpenWRT デフォルトの apache では mod_rewrite が使えないため、
AliasMatch でこれを実現します。</p>

<pre><code>AliasMatch ^/.+$ /root/www/index.html
&lt;Directory "/root/www"&gt;
    Options Indexes FollowSymLinks SymLinksIfOwnerMatch
    AllowOverride None
    Order allow,deny
    Allow from all
&lt;/Directory&gt;
</code></pre>

<p>これにより全てのHTTP アクセス荷対して /index.html の中見を返すようになります。
このHTMLファイル中に、先に挙げたWebページを詰め込んでおきます。</p>

<a name="L............"></a>
<h2>設置場所</h2>

<p>ハニーポットAP は コミックマーケット91 1日目 (2016/12/29) の西ホール1、
み-18a の机の上に設置しました。西ホールのだいたい赤丸の位置に自スペースがあります。</p>

<p><img class="center" src="/images/2017-01-11/map.png" width="200"></p>

<p><img src="/images/2017-01-11/my-space_cap.png"></p>

<p>机の上の可能な限り高いところに、
設置しましたができればポスタースタンドなどにくくりつけてより高さを稼ぎたいところではあります。</p>

<a name="L............"></a>
<h1>提供結果</h1>

<p>ハニーポットAPの提供は 12/29 09:05:29 から 15:09:15 までの期間、6時間3分46秒に渡って実施しました。</p>

<a name="L......LAN"></a>
<h2>無線LAN</h2>

<p>接続しにきたユニーククライアント数は 62 台でした。
この値は、ログ中の接続(Authentication)イベントに紐付くMACアドレスのユニークアドレス数を計上したものです。
なお、いくつかの端末は Authentication Response に対してACKを返せていないため実際にAssociationまで至ったクライアントは
56 台です。</p>

<p>MACアドレスのOUIからベンダ名を引き、分布を図示した物が以下になります。
全体でベンダは10種類でした。コミケという利用環境上、大半がスマートフォンであると推測できます。
この中でも大半が Apple (おそらくiPhone/iPad) と Huawei で占められています。
&ldquo;IEEE Registration Authority&#8221;という名前になっているものがありますが、
一部のスマホでは自社のベンダ名を登録していないためこうなっているようです。</p>

<p><img src="/images/2017-01-11/sta_oui_histogram.png" alt="sta-oui-histogram" /></p>

<p>ハニーポットAPでは2.4/5GHz帯でそれぞれ別のSSIDを告知しています。
以下は帯域毎のユニーク接続クライアント数の分布です。
2.4GHz帯は18端末、5GHz帯は42端末と後者に寄っています。
接続イベント数上も2.4GHz帯は 33回、5GHz帯は 63回となっており、
5GHz帯側に接続しにくることが多かったようです。</p>

<p><img src="/images/2017-01-11/sta_per_band.png" alt="sta-per-band" /></p>

<p>以下は端末の接続持続時間のヒストグラムです。端末が接続してから切断するまでの期間(秒)と発生回数をプロットしています。
10秒単位で丸めています。大半は1分以内ですが、最長で1030秒(17分程度)の場合もあったようです。
300秒にて山がありますが、これは5分毎に走るGTKの更新失敗やらのタイムアウトに起因するものと推測しています。
移動が激しいコミケのような環境では、接続後そのまま明示的に切断せずにクライアントが離脱することが多いため、
このような傾向があるものと考えています。</p>

<p><img src="/images/2017-01-11/sta_dur_histogram.png" alt="sta-dur-histogram" /></p>

<a name="DHCP"></a>
<h2>DHCP</h2>

<p>DHCPサーバがアドレスを割り当てた端末は 50 台でした。
先に述べたとおり、Assocした端末数は56端末であるため6台はDHCPによるアドレス取得まで至らなかったようです。</p>

<p>割り当てたアドレスは10.0.0.0/8から 45 アドレス分でした。
dnsmasqは比較的割り当てアドレスをばらけさせる傾向にありますが、うち5アドレスは重複して配布しています。
デフォルトでは DHCP Lease Time が 1h であるため再利用されたようです。</p>

<p>DHCPクライアントは DHCP Requestのオプションとしてホスト名を付与する場合があります。
このホスト名のユニーク数は今回 39 種でした。
ホスト名文字列として何が付与されるかは端末により異なります。
iOS系だと<strong>〜のiPhone</strong>といった形式、
androidだと<strong>android-XXXXXXXX</strong>といった乱数要素を含んだ文字列を用いる場合があります。
詳細は伏せますが、今回は以下の様な文字列が検出されました。</p>

<ul>
<li>iPhone/iPod Touchと推測されるもの(&ldquo;iphone&rdquo;, &ldquo;ipod&#8221;が含まれる): 14 個</li>
<li>iPadと推測されるもの(&ldquo;ipad&#8221;が含まれる): 5 個</li>
<li>androidと推測されるもの

<ul>
<li>&ldquo;android-XXXXX&rdquo; の形式: 12 個</li>
<li>機種名: 4 個</li>
</ul>
</li>
<li>不明(端末を推測可能な文字列を含まない): 4 個</li>
</ul>


<p>上記に挙げたとおり android にてホスト名に機種名を用いている例が4つありました。
以下の通り全ててHuawei製品であり、このベンダでは一律このポリシーを採っているのかもしれません。</p>

<ul>
<li>HUAWEI_P9</li>
<li>HUAWEI_P9_lite</li>
<li>HUAWEI_Mate_9</li>
<li>Honor_8</li>
</ul>


<a name="DNS.........."></a>
<h2>DNS クエリ</h2>

<p>ハニポAPで動作しているDNSサーバでは期間中に合計556回 DNS クエリを受け取っており、
この対象レコードの内訳は以下の通りです。</p>

<ul>
<li>Aレコード: 504回</li>
<li>AAAAレコード: 50回</li>
<li>PTRレコード: 2回</li>
</ul>


<p>合計 123 個の名前にたいしてクエリを受信しました。
以下はその中で回数の多いほうからトップ10をプロットしたグラフです。
<em>connectivitycheck.gstatic.com</em> や <em>captive.apple.com</em>
のようにキャプティブポータル検知に用いられるホストが多く現れています。
またプッシュ通知を司るホスト向けの通信が多いことも伺えます。</p>

<p><img src="/images/2017-01-11/query_top10.png" alt="query-top10" /></p>

<p>AAAA レコードへのクエリのみを抽出すると、以下の5ホストに対してのクエリを受信していました。
IPv6はサポートしていないため、一律NODATAを返しています。</p>

<ul>
<li>connectivitycheck.gstatic.com</li>
<li>clients3.google.com</li>
<li>mobile.pipe.aria.microsoft.com</li>
<li>a.config.skype.com</li>
<li>b.config.skype.com</li>
</ul>


<a name="L.............................."></a>
<h2>キャプティブポータル</h2>

<p>名前でねじ曲げられた先のキャプティブポータルに対するアクセスは以下のようになっています。</p>

<ul>
<li>HTTPアクセス回数: 246 回</li>
<li>HTTPアクセスのユニーク送信元アドレス数: 43 個

<ul>
<li>うち5つのアドレスは重複割り当ての可能性あり</li>
</ul>
</li>
<li>HTTPアクセス対象ホストのユニーク数: 21 ホスト

<ul>
<li>先のクエリ対象ホストが123だったのに比べるとだいぶ少なめ</li>
<li>HTTPのみ対象のため？</li>
</ul>
</li>
</ul>


<p>以下はアクセス数の多いほうから、ホスト名のトップ10をプロットしたグラフです。
やはりキャプティブポータル検知用ホストへのアクセスが多めです。</p>

<p><img src="/images/2017-01-11/http_host_histogram.png" alt="http-host-histogram" /></p>

<p>アクセス数のヒストグラムをURL全体に拡張し、そのトップ10を並べたものを以下に記載します。
全体では31個のURLに対するアクセスを記録しています。</p>

<p><img src="/images/2017-01-11/http_url_histogram.png" alt="http-url-histogram" /></p>

<p>通常のWebアクセスらしきものや、Simejiの通信なども見えますが
大多数はキャプティブポータル検知用のURLに対するアクセスです。</p>

<ul>
<li>Apple系

<ul>
<li><a href="http://captive.apple.com/hotspot-detect.html">http://captive.apple.com/hotspot-detect.html</a></li>
<li><a href="http://captive.apple.com/XXXXXXXXXX/YYYYYYYYYYY/ZZZZZZZZZZZZZZZZZZZZZ.html">http://captive.apple.com/XXXXXXXXXX/YYYYYYYYYYY/ZZZZZZZZZZZZZZZZZZZZZ.html</a>

<ul>
<li>captive.apple.com はどのパスでも固定の応答が返る模様</li>
</ul>
</li>
</ul>
</li>
<li>Android系

<ul>
<li><a href="http://connectivitycheck.gstatic.com/generate_204">http://connectivitycheck.gstatic.com/generate_204</a></li>
<li><a href="http://clients3.google.com/generate_204">http://clients3.google.com/generate_204</a></li>
<li><a href="http://connectivitycheck.android.com/generate_204">http://connectivitycheck.android.com/generate_204</a></li>
<li><a href="http://10.0.0.1/generate_204">http://10.0.0.1/generate_204</a></li>
</ul>
</li>
</ul>


<p>今回検出したアクセス時のUser-Agentは大別すると以下の4種類に分けられそれぞれ一定の役割のもと
用いられているようです。</p>

<ul>
<li>CaptiveNetworkSupport系</li>
<li>Dalvik系</li>
<li>WebKit系</li>
<li>その他</li>
</ul>


<p>CaptivePortalSupportは主に captive.apple.com 向けの通信に使われていました。
ただしこれだけ、と言うわけではなく以下の様に CaptiveNetworkSupport系とMozilla系のUser-Agentを交互に利用しているようです。</p>

<pre><code>10.0.0.73 GET /hotspot-detect.html FryingPan.lan captive.apple.com "CaptiveNetworkSupport-325.10.1 wispr" 200
10.0.0.73 GET /hotspot-detect.html FryingPan.lan captive.apple.com "Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_3 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13G34" 200
</code></pre>

<p>CaptiveNetworkSupportを含むUser-Agent文字列には以下のパターンが存在していました。
WISPrの仕様上、User-Agent文字列は &ldquo;WISPR!任意の文字列&rdquo; ということになっているので
CaptiveNetworkSupportの文字列の出典および後続する数値列の意味は不明です。</p>

<pre><code>CaptiveNetworkSupport-346 wispr
CaptiveNetworkSupport-325.10.1 wispr
CaptiveNetworkSupport-277.10.5 wispr
CaptiveNetworkSupport-306.20.1 wispr
</code></pre>

<p>Android向けであると推測される connectivitycheck.gstatic.com等へのアクセスは主に Dalvik系 User-Agent から
なされています。が、Apple系とおなじくMozilla系Uer-Agentでのアクセスも確認されています。</p>

<pre><code>10.0.0.13 GET /generate_204 FryingPan.lan connectivitycheck.gstatic.com "Dalvik/2.1.0 (Linux; U; Android 7.0; Nexus 6 Build/NBD91P)" 200
10.0.0.13 GET /generate_204 FryingPan.lan connectivitycheck.gstatic.com "Mozilla/5.0 (Linux; Android 7.0; Nexus 6 Build/NBD91P; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/55.0.2883.91 Mobile Safari/537.36" 200
</code></pre>

<!---

- "KT/6.0.1 An/4.4.2 ko"
  - アプリ内の広告表示アクセスっぽい
- なし
  - simejiっぽい
- "iPad5,3/9.3.3 (13G34)"
  - iOSのPush通知関連？
- "dianxinos-user-agent"
  - Baidu系っぽい
- "LINE/2016.1114.1637 CFNetwork/758.5.3 Darwin/15.6.0"
  - LINE?
- "DXCoreService"
- "com.baidujp.Simeji.SimejiKB/243 CFNetwork/758.5.3 Darwin/15.6.0"
  - Simeji
- "Alamofire"
  - Simejiっぽい

--->


<a name="L........."></a>
<h1>まとめ</h1>

<ul>
<li>コミケ91 1日目にてハニーポットAPを動かしてみた</li>
<li>62人のお客さんが釣れた

<ul>
<li>うち43人程度にはキャプティブWebページを見てもらえた模様</li>
<li>前回 (C90, 10人程度) に比べてだいぶアクセスしてもらえた</li>
</ul>
</li>
<li>キャプティブポータル検知をしてるらしい動きが見れた

<ul>
<li>iphone &amp; android がメイン?</li>
<li>PC系は今回はほぼいないのもあって確認できず</li>
<li>1台だけ Ubuntu マシンがいたが、キャプティブ検知っぽい動作はしていなかった</li>
</ul>
</li>
</ul>


<a name="Future.Work"></a>
<h1>Future Work</h1>

<p>お次やるとしたらこう工夫しようというToDoリスト</p>

<ul>
<li>DHCP リースタイムの延長

<ul>
<li>1日程度の方が良さそう</li>
</ul>
</li>
<li>運用時の可視化方法

<ul>
<li>本当は ruby 動かして管理用 WebUI が見れるはずだったけど、上手く動かなかった</li>
</ul>
</li>
<li>自律的な時刻同期

<ul>
<li>会期中一回落ちて時刻がおかしくなった</li>
<li>3G/LTE で NTP ?</li>
</ul>
</li>
<li>電源モジュールの基板化

<ul>
<li>ブレッドボードはつらい</li>
</ul>
</li>
<li>DHCP Fingerprinting で遊びたい</li>
<li>別の場所での運用

<ul>
<li>PC が多そうな環境で見てみたい</li>
</ul>
</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[イベント無線LANでのチャネル使用率調査]]></title>
    <link href="http://enukane.github.io/blog/2015/08/31/event-radio-utilization/"/>
    <updated>2015-08-31T18:20:55+09:00</updated>
    <id>http://enukane.github.io/blog/2015/08/31/event-radio-utilization</id>
    <content type="html"><![CDATA[<a name="L......"></a>
<h2>概要</h2>

<p>いつもやっている、イベント会場でのパケットキャプチャに加えてここ最近チャネルごとの使用率の収集も始めました。</p>

<a name="L............"></a>
<h3>計測対象</h3>

<p>今回、計測対象にしたのは以下の4イベント(7回)。大抵、鞄の中にデバイスを入れて移動しつつパケットキャプチャを行っています。設置場所を確保できた場合、定点観測的に収集をしています。</p>

<table>
<thead>
<tr>
<th style="text-align:left;">イベント              </th>
<th style="text-align:left;">日             </th>
<th style="text-align:center;">場所                           </th>
<th style="text-align:center;"> 固定? </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">なにか                </td>
<td style="text-align:left;"> 2015/08/02    </td>
<td style="text-align:center;">どこか                         </td>
<td style="text-align:center;"> <strong>Y</strong> </td>
</tr>
<tr>
<td style="text-align:left;">コミケ (C88)          </td>
<td style="text-align:left;"> 2015/08/14    </td>
<td style="text-align:center;">東京ビッグサイト ホール(東、西)</td>
<td style="text-align:center;"> N     </td>
</tr>
<tr>
<td style="text-align:left;">                      </td>
<td style="text-align:left;"> 2015/08/15    </td>
<td style="text-align:center;">東京ビッグサイト ホール(東、西)</td>
<td style="text-align:center;"> N     </td>
</tr>
<tr>
<td style="text-align:left;">                      </td>
<td style="text-align:left;"> 2015/08/16    </td>
<td style="text-align:center;">東京ビッグサイト ホール(東)    </td>
<td style="text-align:center;"> <strong>Y</strong> </td>
</tr>
<tr>
<td style="text-align:left;">YAPC::Asia Tokyo 2015 </td>
<td style="text-align:left;"> 2015/08/14    </td>
<td style="text-align:center;">東京ビッグサイト 会議棟        </td>
<td style="text-align:center;"> N     </td>
</tr>
<tr>
<td style="text-align:left;">                      </td>
<td style="text-align:left;"> 2015/08/14    </td>
<td style="text-align:center;">東京ビッグサイト 会議棟        </td>
<td style="text-align:center;"> N     </td>
</tr>
<tr>
<td style="text-align:left;">コミティア113         </td>
<td style="text-align:left;"> 2015/08/30    </td>
<td style="text-align:center;">東京ビッグサイト ホール(2,3)   </td>
<td style="text-align:center;"> N     </td>
</tr>
</tbody>
</table>


<a name="L.........................................."></a>
<h2>チャネル利用率のヒートマップ</h2>

<p>5分毎に区切って、チャネルごとにヒートマップ化したものを並べてみる。</p>

<a name="L2015.08.02........................."></a>
<h3>2015/08/02 あたりのイベント</h3>

<p><img src="/images/2015-08-31/ev0802-util.png" alt="2015-08-02-util" /></p>

<a name="L...........C88."></a>
<h3>コミケ (C88)</h3>

<p>コミケでは、1日目および2日目は一般参加、三日目のみサークル参加だったため東 P-18b にて定点観測を実施。
動的観測の場合、列に並んだあとに観測開始し買い物が終わってビッグサイトから出て国際展示場に行くまでの間のどこかで停止している。</p>

<ul>
<li>列に並んだ時間 (西)

<ul>
<li>1日目: 10:15頃</li>
<li>2日目: 10:10頃</li>
</ul>
</li>
<li>ビッグサイトを出た時間

<ul>
<li>1日目: 12:50頃</li>
<li>2日目: 11:10頃</li>
</ul>
</li>
<li>彷徨ったルート (覚えてる範囲で)

<ul>
<li>1日目: 西(入場) → 東123→東456→西(退場)</li>
<li>2日目: 西(入場) → 東123→東456→西(ホール)→西(退場)</li>
</ul>
</li>
</ul>


<a name="L1........2015.08.14."></a>
<h4>1日目 (2015/08/14)</h4>

<p><img src="/images/2015-08-31/c88-d1.png" alt="2015-08-14-util" /></p>

<a name="L2........2015.08.15."></a>
<h4>2日目 (2015/08/15)</h4>

<p><img src="/images/2015-08-31/c88-d2.png" alt="2015-08-15-util" /></p>

<a name="L3........2015.08.16."></a>
<h4>3日目 (2015/08/16)</h4>

<p><img src="/images/2015-08-31/c88-d3.png" alt="2015-08-16-util" /></p>

<a name="YAPC::Asia.Tokyo.2015"></a>
<h3>YAPC::Asia Tokyo 2015</h3>

<p>こちらは CONBU チーム (いわゆる Wi-Fi 班)として参加したときのもの. 作業時に邪魔にならない場合、ショルダーバッグにデバイスを入れて彷徨うようにはしていました. が、バックヤードに起きっぱなしの時間も大分あったため有為なデータが取れていない可能性は多々ありそう。</p>

<a name="L1........2015.08.21."></a>
<h4>1日目 (2015/08/21)</h4>

<p><img src="/images/2015-08-31/yapc2015-d1.png" alt="2015-08-21-util" /></p>

<a name="L2........2015.08.22."></a>
<h4>2日目 (2015/08/22)</h4>

<p><img src="/images/2015-08-31/yapc2015-d2.png" alt="2015-08-22-util" /></p>

<a name="L...............113..2015.08.30."></a>
<h3>コミティア113 (2015/08/30)</h3>

<p><img src="/images/2015-08-31/comitia113.png" alt="2015-08-22-util" /></p>

<a name="L......"></a>
<h2>考察</h2>

<ul>
<li>何となく移動が見える

<ul>
<li>特にビッグサイト(ホール)

<ul>
<li>5GHz帯 36、48、64、100 chの濃淡

<ul>
<li>ホールから抜けたかどうかが判断できそう</li>
</ul>
</li>
<li>C88 1日目、2日目の移動に連動していそう?</li>
</ul>
</li>
<li>YAPCの結果を見ても、場所変化には連動している模様</li>
<li>Wi-Fiをオフされた時も同様の状況になりうるので一概に逆は言えないが&hellip;.</li>
</ul>
</li>
<li>2.4GHz帯側の分布具合

<ul>
<li>8/2 と YAPCのそれはだいぶ綺麗にみえる

<ul>
<li>1、6、11 chの中央とそれらの両隣が濃く出ている</li>
<li>これらのイベントでは、会場内無線LANのコントロールが提供側でそこそこなされていたため？</li>
<li>野良APまたはクライアントの絶対数の有無?</li>
</ul>
</li>
<li>&ldquo;人の密集度 == 2.4GHz帯側の濃度&rdquo; という仮説

<ul>
<li>C88 1日目、2日目の2.4GHz と 5GHz の比較より</li>
<li>ホールから出て 5GHz 帯側が明らかに薄くなっていて、2.4GHz帯側はそこまで落ちない時間がある

<ul>
<li>まだ列に並んでると思しき時間</li>
<li>ホール間移動と思しき時間</li>
<li>帰途についてビッグサイトを出たと思しき時間</li>
</ul>
</li>
<li>モバイルルータの影響？</li>
</ul>
</li>
</ul>
</li>
</ul>


<a name="L......"></a>
<h2>実装</h2>

<p>以下、軽く実装についてメモ</p>

<a name="L................................."></a>
<h3>情報源として用いる情報</h3>

<p>チャネル利用率の算出には iw コマンドの以下のオプションを用いました。</p>

<pre><code>% iw wlan0 survey dump
</code></pre>

<p>survey dumpでは以下の様にそのチャネルに移動してからのアクティブ時間(=移動後の経過時間)とビジーだった時間が得られます。</p>

<pre><code>Survey data from wlan0
        frequency:                      2412 MHz [in use]
        noise:                          -83 dBm
        channel active time:            35900 ms
        channel busy time:              24814 ms
        channel transmit time:          0 ms
</code></pre>

<p>今回用いたデバイス(WLP-UC-AG300, チップはRT2870)の場合、この値はソースコード上の以下の部分で計算しています。
<a href="https://github.com/torvalds/linux/blob/master/drivers/net/wireless/rt2x00/rt2800lib.c#L7984">https://github.com/torvalds/linux/blob/master/drivers/net/wireless/rt2x00/rt2800lib.c#L7984</a></p>

<p>なおここでの&#8221;ビジー&#8221;は、送受信またはノイズによりこれらがストップしていたチップの動作時間であり、以下の様な関係式がなりたちます。</p>

<pre><code>channel busy time   = receive time + transmit time + other time
channel active time = busy time + idle time
</code></pre>

<p>チップによっては transmit time の他に receive time も個別に取り出せるので other つまり 802.11 以外の電波により送受信ができていなかった時間も取れるのですが今回は対象外としました。</p>

<a name="tochkad............."></a>
<h3>tochkad での記録</h3>

<p>このように取れるチャネル利用率を、パケットキャプチャデバイスの主観部分を担う <a href="https://github.com/enukane/tochka/">tochkad</a> のチャネル遷移部分で取得するようにしました。</p>

<ul>
<li><a href="https://github.com/enukane/tochka/blob/master/lib/tochka/athsurvey.rb">athsurvey.rb</a></li>
</ul>


<p>tochkadは0.5秒毎にチャネル遷移するので大分短い時間ではありますが、ログ上に以下の様に utilization (利用率)が載るようになります。</p>

<pre><code>[2015-08-02 15:20:43 +0900]     DEBUG: channel moved to 11 from 10 (dur=6510、size=481767780、walk=6062、utilization=59.68 uch=10)
</code></pre>

<p>この利用率は tochka デバイスについている LCD ディスプレイ (tochka-miniui) にも出すようにしています (赤枠部分)</p>

<p><img src="/images/2015-08-31/tochka-miniui.jpg" alt="tochka-miniui" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SIGCOMM2015: Large-scale Measurements of Wireless Network Behavior を読む]]></title>
    <link href="http://enukane.github.io/blog/2015/08/28/sigcomm2015-large-scale-wlan-net/"/>
    <updated>2015-08-28T09:10:56+09:00</updated>
    <id>http://enukane.github.io/blog/2015/08/28/sigcomm2015-large-scale-wlan-net</id>
    <content type="html"><![CDATA[<a name="L......"></a>
<h2>概要</h2>

<p>リンク: <a href="http://conferences.sigcomm.org/sigcomm/2015/pdf/papers/p153.pdf">http://conferences.sigcomm.org/sigcomm/2015/pdf/papers/p153.pdf</a></p>

<ul>
<li>SIGCOMM &lsquo;15で発表された論文。Cisco Merakiの人たちが著者。</li>
<li>Merakiはいわゆるクラウド型無線LANコントローラとAPのセットのサービス。</li>
<li>自社のサービスを展開している中で収集されたデータのオーバービュー的な文章。</li>
</ul>


<a name="L.............................."></a>
<h3>読んだモチベーション</h3>

<ul>
<li>Wireless Network という題に惹かれて</li>
<li>お仕事で似た様なことやってるため</li>
</ul>


<a name="L......"></a>
<h2>内容</h2>

<p><a href="http://lafrenze.hatenablog.com/entry/2015/08/04/120205">落合先生フォーマット</a>に従って並べてみる</p>

<a name="L.................."></a>
<h3>どんなもの？</h3>

<ul>
<li>Merakiのサービスを提供するに当たって収集したデータの分析を行った

<ul>
<li>2万台のMeraki AP, 2万個のネットワーク, 5百万クライアント/week の規模</li>
<li>これらのネットワークにぶら下がる数百万のデバイスの様々な情報が自社のDBに溜まっている

<ul>
<li>ネットワークに所属するデバイスたち: AP, クライアント端末(ノートPC, スマホ e.t.c), スイッチ, ルータ など</li>
<li>情報: 接続断のイベント, 通信先 など</li>
<li>Meraki(のサービス側)は, いわゆる無線LANコントローラなのでこれらの情報を常にpolling/収集している</li>
</ul>
</li>
</ul>
</li>
<li>これだけ規模が大きく, 期間も長いと&#8221;無線LANネットワークのトレンド&#8221;的なものが見えてくる

<ul>
<li>電波的な傾向

<ul>
<li>他のAP or 802.11以外の干渉</li>
</ul>
</li>
<li>規格上の傾向

<ul>
<li>2.4 or 5GHz帯への偏り</li>
<li>802.11g, a, n, acの偏り(利用率の変化)</li>
<li>チャネル幅の遷移</li>
<li>ストリーム数の遷移</li>
</ul>
</li>
<li>クライアントの傾向

<ul>
<li>OSのバリエーション</li>
<li>信号強度</li>
</ul>
</li>
<li>ネットワークの傾向

<ul>
<li>いわゆる普通のトラフィック分析</li>
<li>アプリケーション利用率</li>
</ul>
</li>
</ul>
</li>
</ul>


<a name="L........................................................."></a>
<h3>先行研究と比べて何がすごい？何が違う？</h3>

<ul>
<li>まず数

<ul>
<li>Gemberら(当該研究者が所属する大学ネットワークや施設のネットワークが対象)、Rodrigら(カンファレンスネットワークが対象)等、干渉の計測やネットワークトラフィックの分析を行った研究は存在する。この論文では、さらに大規模なユーザベースでの分析を行っている。</li>
<li>Hotspotを対象にそこそこの規模で行った例としては Ghoshら(243000デバイス)、Google (500AP, 30000クライアント)等があるがこれらはあくまでHotspot向けであり、この論文(およびMerakiのサービス)が対象としているオフィス/キャンパスユースではない</li>
</ul>
</li>
<li>計測期間の長さ (とそこから来るデータ量)

<ul>
<li>おもに他の研究ではショットないし1年内程度のスパンで行ったものが主

<ul>
<li>短いスパンであれば、個々の技術・計測に関する分析を行った既存研究は多種存在する</li>
<li>干渉の定性的分析や規格の技術的妥当性の検証という観点で</li>
</ul>
</li>
<li>この論文では5年程度のスパンで見ている

<ul>
<li>&ldquo;トレンド&#8221;という点に着目できる内容になっている</li>
<li>さらに取得した、サービスの継続にあたって重要な無線LANインフラ(!=無線LAN only)の情報を分析対象としている</li>
</ul>
</li>
</ul>
</li>
</ul>


<a name="L......................................."></a>
<h3>技術の手法とかキモはどこ？</h3>

<ul>
<li>サービスのプロダクション環境に当該情報収集系を組み込んだところ

<ul>
<li>いわゆる&#8221;実用&#8221;の場でのデータが取れる</li>
<li>お客さんのバリエーション == &ldquo;実用”の度合い に直結する</li>
</ul>
</li>
<li>観点として「サービスの継続性」のための情報収集に特化しているところ

<ul>
<li>個々の規格・技術の妥当性検証というよりは、その現れ方・利用され方の観測が主</li>
</ul>
</li>
</ul>


<a name="L.........................................."></a>
<h3>どうやって有効だと検証した？</h3>

<ul>
<li>Evaluationとして有効性を示す文章はない</li>
<li>強いて言えば実環境でこんな感じのデータが取れたぜ！という報告に近い?</li>
</ul>


<a name="L.................."></a>
<h3>議論はある？</h3>

<ul>
<li>(TBD)</li>
</ul>


<a name="L.............................."></a>
<h3>次に読むべき論文は？</h3>

<ul>
<li>GamberらのとGoogleのやつ？

<ul>
<li><ol type="a">
<li>Gember, A. Anand, and A. Akella. A comparative study of handheld and non-handheld traffic in campus wi-fi networks.</li>
</ol>
</li>
<li><ol type="a">
<li>Afanasyev, T. Chen, G. M. Voelker, and A. C. Snoeren. Usage patterns in an urban wifi network</li>
</ol>
</li>
</ul>
</li>
<li>Senらの&#8221;Cspy: finding the best quality channel without probing&#8221;も気になる

<ul>
<li><ol type="a">
<li>Sen, B. Radunovic, J. Lee, and K.-H. Kim. Cspy: finding the best quality channel without probing.</li>
</ol>
</li>
</ul>
</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[貧乏人でもスペアナがしたい!]]></title>
    <link href="http://enukane.github.io/blog/2015/05/01/bimbo-spectrum-analyzer/"/>
    <updated>2015-05-01T12:51:00+09:00</updated>
    <id>http://enukane.github.io/blog/2015/05/01/bimbo-spectrum-analyzer</id>
    <content type="html"><![CDATA[<a name="L......................................................"></a>
<h2>貧乏人でもスペアナがしたい!(掲題ママ)</h2>

<p>新品を買うと, 数十万〜数百万だし, ヤフオク等の中古品でも明らかなジャンク品でないものに限ったとしても十〜数十万ぐらいは行ってしまう.</p>

<p>やりたいことができて, こわしても気落ちしない程度のモノが欲しいので探してみたメモ.</p>

<p>やりたいことベースでのおおよその要件は以下の通り
(貧乏人にしては盛りすぎだ!生意気だ!等のコメントはNO)</p>

<ul>
<li>(MUST) 無線LANの周波数帯がカバーできること

<ul>
<li>2.4 &amp; 5GHz帯</li>
</ul>
</li>
<li>(MUST) PCと連携できること

<ul>
<li>(SHOULD) 外部のスクリプト等で扱える形式でデータがエクスポートできること</li>
<li>(MAY) あるいは, 独自形式でもかまわないが仕様が公開されていること</li>
</ul>
</li>
<li>(MUST) 数十万円後半は絶対にNO

<ul>
<li>10〜20万ぐらいが限度</li>
</ul>
</li>
<li>(MAY) RBW と sweeptimeの両立がそこそこ成り立つこと

<ul>
<li>(MAY) できれば20/40MHzスパンに対して200〜300kHzのRBWで数百ms程度が望ましい (秒はかからない程度であれば)</li>
</ul>
</li>
<li>(MAY) できれば普通のスペアナと同じような汎用性

<ul>
<li>スペアナのお勉強用に使えること</li>
</ul>
</li>
<li>(MAY) Mac向けのアプリがあること

<ul>
<li>(MAY) あるいはUNIX系からアクセス可能なインタフェース(ライブラリ/API etc)が用意されていること</li>
</ul>
</li>
<li>(MAY) USBバスパワーで動くこと</li>
<li>(MAY) 携帯可能な電源仕様, 形状, 重さであること</li>
</ul>


<p>おおよそ2つの側面があって, きちんとしたスペアナ買ってお勉強したいというのと, 今までやってきている無線LANキャプチャに織り交ぜたいという2つの方向からの要求が混ざっている. 分けた方がいいような気はする.</p>

<a name="L................................."></a>
<h2>候補になりそうな人たち</h2>

<p>中古のスペアナをヤフオクで探すのは継続するとして, ハンディに使えそうな子達.</p>

<ul>
<li>Giga ST</li>
<li>RF Explorer 6G Combo</li>
<li>Aaronia AG

<ul>
<li>SPECTRAN HF-6060V4</li>
<li>SPECTRAN HF-6060V4 X</li>
</ul>
</li>
<li>Metageek WiSpy DBx</li>
<li>Signal Hound

<ul>
<li>USB-SA124B</li>
<li>BB60C</li>
</ul>
</li>
<li>Tektronix RSA306</li>
</ul>


<table>
<thead>
<tr>
<th style="text-align:left;">機種</th>
<th style="text-align:right;">お値段</th>
<th style="text-align:center;">周波数レンジ</th>
<th style="text-align:left;">RBW</th>
<th>スイープ時間</th>
<th>アプリ対応OS</th>
<th> export可? </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">GigaSt v5c</td>
<td style="text-align:right;">29,000 (税, 送料込み)</td>
<td style="text-align:center;">3 - 12000MHz</td>
<td style="text-align:left;">15/30/180 KHz</td>
<td>500ms? (SPAN:100MHz, RBW:180KHz)</td>
<td>Windows</td>
<td> 形式不明 </td>
</tr>
<tr>
<td style="text-align:left;">RF Explorer 6G Combo</td>
<td style="text-align:right;">43,800 (税込み)</td>
<td style="text-align:center;">15 - 2700MHz, 4850 - 6100 MHz</td>
<td style="text-align:left;"> 2.6 - 812 kHz </td>
<td> 200ms? (Span: 60MHz, 600KHz) </td>
<td>Windows, Mac(?) </td>
<td> XML/CSV </td>
</tr>
<tr>
<td style="text-align:left;">SPECTRAN HF-6060V4</td>
<td style="text-align:right;"> €999.95 (129,384) </td>
<td style="text-align:center;"> 10MHz - 6GHz </td>
<td style="text-align:left;"> 3kHz - 50MHz </td>
<td> 200ms (Span: 20MHz, RBW: 300kHz) </td>
<td> Windows, Linux, Mac </td>
<td> CSV </td>
</tr>
<tr>
<td style="text-align:left;">SPECTRAN HF-6060V4 X</td>
<td style="text-align:right;"> €999.95 (129,384) </td>
<td style="text-align:center;"> 10MHz - 6GHz </td>
<td style="text-align:left;"> 3kHz - 50MHz </td>
<td> 200ms (Span: 20MHz, RBW: 300kHz) </td>
<td> Windows, Linux, Mac </td>
<td> CSV </td>
</tr>
<tr>
<td style="text-align:left;">WiSpy DBx</td>
<td style="text-align:right;"> $1,149 (136,834) </td>
<td style="text-align:center;"> 2.4GHz帯, 5GHz帯 </td>
<td style="text-align:left;"> 500ms (Span: 95MHz, RBW: 333KHz) </td>
<td> 500ms or 1s ? </td>
<td>Windows, Mac </td>
<td> sqlite DB </td>
</tr>
<tr>
<td style="text-align:left;">USB-SA124B</td>
<td style="text-align:right;"> $1,995 (238,386) </td>
<td style="text-align:center;"> 100kHz - 12.4GHz </td>
<td style="text-align:left;"> 100Hz - 250KHz, 6MHz </td>
<td> </td>
<td> Windows </td>
<td> ? </td>
</tr>
<tr>
<td style="text-align:left;">BB60C</td>
<td style="text-align:right;"> $2,879 (342,860) </td>
<td style="text-align:center;"> 9kHz - 6GHz </td>
<td style="text-align:left;"> 10khz </td>
<td> 24GHz/sec </td>
<td> Windows </td>
<td> ? </td>
</tr>
<tr>
<td style="text-align:left;">RSA306</td>
<td style="text-align:right;">434,000</td>
<td style="text-align:center;">9kHz - 6.2GHz</td>
<td style="text-align:left;"> 10Hz - 10MHz </td>
<td> 100us (Span: 400MHz, RBW: 300KHz) </td>
<td> Windows </td>
<td> CSV </td>
</tr>
</tbody>
</table>


<a name="L..............."></a>
<h3>諸々の前提</h3>

<ul>
<li>とりあえず無線LANターゲットなので, スパンとして20/40/80/160MHzがありうる

<ul>
<li>OFDMの各キャリアは312.5KHz間隔</li>
</ul>
</li>
<li>RBWと掃引時間の関係: sweeptime [s] = (k * span [Hz]) / (RBW [Hz])<sup>2</sup>

<ul>
<li>掃引時間はRBWの二乗に反比例</li>
<li>掃引時間は周波数スパンに比例</li>
</ul>
</li>
</ul>


<a name="L......"></a>
<h2>候補</h2>

<a name="GigaSt.v5c"></a>
<h3>GigaSt v5c</h3>

<ul>
<li><p>参考</p>

<ul>
<li><a href="http://www.wa.commufa.jp/gigast/GigaSt5/GigaSt-v5.html">http://www.wa.commufa.jp/gigast/GigaSt5/GigaSt-v5.html</a></li>
<li><a href="https://www.youtube.com/watch?v=3vLZrA0e8EY">https://www.youtube.com/watch?v=3vLZrA0e8EY</a></li>
</ul>
</li>
<li><p>Pros</p>

<ul>
<li>安い! (送料込みで3万円以下)</li>
<li>USBバスパワー駆動</li>
<li>内部的にはシリアル(VCP) &amp; コントロール等々のドキュメントはそろってるので他OSでも触るのは簡単そう</li>
</ul>
</li>
<li>Cons

<ul>
<li>ケースはないので自分で用意</li>
<li>「グラフデータ保存機能」でどんな形式がサポートされてるか</li>
<li>注文ウィンドウがよく分からない (受付してない時期がある?)</li>
</ul>
</li>
</ul>


<a name="RF.Explorer.6G.Combo...WiFi.Combo"></a>
<h2>RF Explorer 6G Combo / WiFi Combo</h2>

<ul>
<li><p>参考</p>

<ul>
<li><a href="http://rfexplorer.com/combo-specs/">http://rfexplorer.com/combo-specs/</a></li>
<li><a href="https://www.youtube.com/watch?v=3ZhdcUJanCI">https://www.youtube.com/watch?v=3ZhdcUJanCI</a></li>
</ul>
</li>
<li><p>Pros</p>

<ul>
<li>コンパクト</li>
<li>そこそこお安い(5万内)</li>
<li>千石電商でも売っているので手には入れやすい</li>
<li>デバイスにLCDがついてる</li>
<li>バッテリー付き(16時間+ぐらいは動くらしい)</li>
<li>こちらも内部的にはシリアルっぽいのでコマンド叩けばいろいろ遊べる (<a href="https://code.google.com/p/rfexplorer/">rfexplorer</a>)</li>
</ul>
</li>
<li>Cons

<ul>
<li>2700MHz〜4850MHzの間は計測不可

<ul>
<li>とはいっても今のところ使い道はない</li>
</ul>
</li>
<li>基本となるアプリ(<a href="http://rfexplorer.com/touchstone/">touchstone</a>)は無料だけど, 一部のアプリが有料 ($49)

<ul>
<li>有料版(PRO)でないとxml/csvへのエクスポート機能がない</li>
</ul>
</li>
</ul>
</li>
</ul>


<a name="Aaronia.SPECTRAN.HF-6060V4...HF-6060V4.X"></a>
<h2>Aaronia SPECTRAN HF-6060V4 / HF-6060V4 X</h2>

<ul>
<li>参考

<ul>
<li><a href="http://www.aaronia.com/products/spectrum-analyzers/HF-6060-V4-RF-Spectrum-Analyzer/">SPECTRAN HF-6060 V4</a></li>
<li><a href="http://www.aaronia.com/products/spectrum-analyzers/HF-6060-V4-X-USB-remote-Analyzer/">SPECTRAN HF-6060 V4 X</a></li>
</ul>
</li>
</ul>


<p>V4はいわゆるハンドヘルド版で, V4 Xがデスクトップ向け.</p>

<ul>
<li>Pros

<ul>
<li><a href="http://www.aaronia.com/products/software/">MCS</a>なるアプリが無料, Win/Mac/Linuxをそれぞれサポートしてる</li>
<li>V4ハンドヘルド版は単体で動作可能</li>
<li>サポートしてる周波数帯は基本的に連続 (どこかで途切れてる可能性はあるが)</li>
<li>悪くない価格 (11万程度)</li>
</ul>
</li>
<li>Cons

<ul>
<li>V4 XがUSBバスパワーだけでは動かない. 動いたら完璧だったのに&hellip;

<ul>
<li>モバイルバッテリーでは無理だろうが, DCなバッテリー + 電源ケーブル調達でなんとかなりそうではある</li>
</ul>
</li>
<li>V4ハンドヘルド版の動作時間は?</li>
<li>V4とV4 Xの機能面での差は?

<ul>
<li>LCD, ジョグダイヤルの有無</li>
<li>付属アンテナ:</li>
<li>HyperLOG EMC directional LogPer antenna: 7060 vs なし</li>
<li>OmniLOG 90200 radial isotropic antenna: なし vs あり</li>
<li>Xのみ: マーカの数unlimited, 複数デバイス操作可, スイープポイント無限等々

<ul>
<li>Xの方にだけPRO版ソフト?とやらが付いてくるらしいが?</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


<a name="WiSpy.DBx"></a>
<h2>WiSpy DBx</h2>

<ul>
<li>参考

<ul>
<li><a href="http://www.metageek.com/products/wi-spy/">WiSpy</a></li>
</ul>
</li>
</ul>


<p>「無線LAN &amp; スペアナ」でググると一番最初に出てくるデファクトスタンダード品みたいなもの.</p>

<ul>
<li>Pros

<ul>
<li>無線LANに特化

<ul>
<li>AP(SSID)一覧との紐付けが標準で存在している</li>
<li>「チャネル:周波数」の変換</li>
</ul>
</li>
<li>Macのアプリがある (Channalyzer)</li>
<li>kismetが出してる<a href="https://www.kismetwireless.net/spectools/">spectools</a>を使えばLinuxでも動きそう</li>
</ul>
</li>
<li>Cons

<ul>
<li>スペアナと見たときに, 細かいことがあまりできない

<ul>
<li>細かいパラメータがいじれない</li>
<li>無線LAN以外にはあまり使えなさそう

<ul>
<li>無線LAN特化のスペアナという立ち位置</li>
<li>現状無線LAN以外に使う予定はないが, 勉強用なので諸々のパラメータは弄りたい</li>
</ul>
</li>
<li>5GHz帯は細かくチャネルごとに見れない

<ul>
<li>2.4GHz帯はチャネル毎に見れる</li>
</ul>
</li>
</ul>
</li>
<li>その割には値段が高い (13万ぐらい)</li>
</ul>
</li>
</ul>


<p>スイープの性能については以下の通り. 見てる幅により固定になっている.</p>

<ul>
<li>2.4GHz 全体

<ul>
<li>Span: 95.310MHz ( 2400 - 2495 MHz )</li>
<li>RBW: 333.3 KHz</li>
<li>スイープ時間: 500ms?</li>
</ul>
</li>
<li>2.4GHz各チャネル (例としてチャネル 1)

<ul>
<li>Span: 424MHz ( 2400 - 2424 MHz )</li>
<li>RBW: 100kHz</li>
<li>スイープ時間: 500ms?</li>
</ul>
</li>
<li>5GHz

<ul>
<li>Span: 676.7 MHz ( 5160 - 5836 MHz )</li>
<li>RBW: 150.0 KHz</li>
<li>スイープ時間: 1s?</li>
</ul>
</li>
</ul>


<a name="Signal.Hound.USB-SA124B...BB60C"></a>
<h2>Signal Hound USB-SA124B / BB60C</h2>

<ul>
<li><p>参考</p>

<ul>
<li><a href="https://signalhound.com/products/bb60c/">BB60C</a></li>
<li><a href="https://signalhound.com/products/usb-sa124b/">USB-SA124B</a></li>
<li><a href="https://www.youtube.com/watch?v=OWrp4M-T2r0">BBC60 Demo and Remote</a></li>
<li><a href="https://www.youtube.com/playlist?list=PL3IOktxB0nG5baFmDHwiZrb284akt6n9K">SA-Series Videos</a></li>
</ul>
</li>
<li><p>Pros</p>

<ul>
<li>スぺアナというよりはHackRFとかUSRPみたいなSDRデバイス + スペアナができるアプリという感じ</li>
<li>BB60Cに至っては24GHz/sec sweep speed (>= 10kHz RBW)</li>
</ul>
</li>
<li>Cons

<ul>
<li>お値段は微妙 (RSA306に手が届きそうな値段)</li>
<li>スペアナというよりSDR. これかうならHackRF買った方がよさそうな気はする.</li>
</ul>
</li>
</ul>


<a name="Tektronix.RSA306"></a>
<h2>Tektronix RSA306</h2>

<ul>
<li><a href="http://jp.tek.com/spectrum-analyzer/rsa306-0">RSA306型USBスペクトラム・アナライザ</a></li>
</ul>


<p>Tektronixが出した「USBリアルタイムスペクトラムアナライザ」</p>

<ul>
<li>Pros

<ul>
<li>反応めっちゃはやい

<ul>
<li>40MHz幅内ならRBW 120KHzぐらいまでならだいぶぬるぬる表示する</li>
</ul>
</li>
<li>ソフトはタダ (基本部分は, という条件付きだが)</li>
<li>USB3.0ポート一つで制御・電源供給</li>
</ul>
</li>
<li>Cons

<ul>
<li>お値段

<ul>
<li>とはいえこの性能比で考えれば破格. 単純に予算の問題</li>
</ul>
</li>
</ul>
</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Chokaigi 2015 Wi-Fiみてきた]]></title>
    <link href="http://enukane.github.io/blog/2015/04/28/chokaigi2015-wifi/"/>
    <updated>2015-04-28T17:31:09+09:00</updated>
    <id>http://enukane.github.io/blog/2015/04/28/chokaigi2015-wifi</id>
    <content type="html"><![CDATA[<p>ニコニコ超会議2015で Free Wi-Fi が提供されている、とのことだったので
どんな感じなのか偵察に行くついでにいつもの如くパケットあつめて
データをまとめてみた.</p>

<p><iframe src="http://www.slideshare.net/slideshow/embed_code/47427093 " width="595" height="446" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px" allowfullscreen></iframe> </p>
]]></content>
  </entry>
  
</feed>
